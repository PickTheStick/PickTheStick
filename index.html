<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PTS! - Home Page</title>
    <link rel="stylesheet" href="./style/style.css">
</head>
<body>
    <div class="container">
        <button id="navigateToLeaderboard">Today's Leaderboard</button>
        <h1>MLB Player Performance Tracker</h1>
        <form id="playerPerformanceForm">
            
            <label for="user">User:</label>
            <input type="text" id="user" required><br><br>

            <label for="division">Select Division:</label>
            <select id="division">
                <option value="All">All Divisions</option>
                <option value="AL West">AL West</option>
                <option value="AL East">AL East</option>
                <option value="AL Central">AL Central</option>
                <option value="NL West">NL West</option>
                <option value="NL East">NL East</option>
                <option value="NL Central">NL Central</option>
            </select><br><br>

            <label for="team">Select Team:</label>
            <select id="team">
                <option value="">Select Team</option>
                <!-- Options for selecting MLB teams will be dynamically populated here -->
            </select><br><br>
            
            <label for="player">Select Player:</label>
            <select id="player">
                <option value="">Select Player</option>
                <!-- Options for selecting players will be dynamically populated here -->
            </select><span class="sub-point green">Must Select Team First</span>
            <br><br>
            
            <label for="gameDate">Today's Date:</label>
            <!-- Display today's date as text, not editable -->
            <input type="text" id="gameDate" disabled><br><br>

            <button type="button" id="pickTheStickButton" class="patterned-button">Pick the Stick</button>
        </form>

        <div id="performanceDetails">
            <!-- Performance details will be displayed here -->
        </div>
    </div>
    
    <div class="admin-buttons">
        <button id="turnOffPicks" class="small-button">Turn Off Picks</button>
        <button id="turnOnPicks" class="small-button">Turn On Picks</button>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="./apps/mlb.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date(); // Get today's date
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
            const day = String(today.getDate()).padStart(2, '0');

            const formattedDate = `${year}-${month}-${day}`;
            document.getElementById('gameDate').value = formattedDate;

            document.getElementById('navigateToLeaderboard').addEventListener('click', function() {
                window.location.href = 'leaderboard.html';
            });

            const pickTheStickButton = document.getElementById('pickTheStickButton');
            const turnOffPicksButton = document.getElementById('turnOffPicks');
            const turnOnPicksButton = document.getElementById('turnOnPicks');
            const adminPassword = 'boobs'; // Replace with actual secure logic

            pickTheStickButton.addEventListener('click', function() {
                const user = document.getElementById('user').value;
                const playerElement = document.getElementById('player');
                const player = playerElement.value;
                const playerName = playerElement.options[playerElement.selectedIndex].text;

                if (user && player) {
                    const picksEnabled = localStorage.getItem('picksEnabled');
                    if (picksEnabled === 'false') {
                        alert('It is past time to pick the stick. Picks are currently disabled.');
                        return;
                    }

                    const lastPickDate = localStorage.getItem(`${user}_lastPickDate`);
                    const currentDate = formattedDate;

                    if (lastPickDate === currentDate) {
                        alert('You have already made a pick today.');
                        return;
                    }

                    localStorage.setItem(`${user}_lastPickDate`, currentDate);
                    localStorage.setItem('selectedPlayer', JSON.stringify({ user, playerName, gameDate: formattedDate }));
                    window.location.href = 'leaderboard.html';
                } else {
                    alert('Please fill in all fields.');
                }
            });

            turnOffPicksButton.addEventListener('click', function() {
                const password = prompt('Enter admin password:');
                if (password === adminPassword) {
                    localStorage.setItem('picksEnabled', 'false');
                    alert('Picks turned off.');
                } else {
                    alert('Incorrect password.');
                }
            });

            turnOnPicksButton.addEventListener('click', function() {
                const password = prompt('Enter admin password:');
                if (password === adminPassword) {
                    localStorage.setItem('picksEnabled', 'true');
                    alert('Picks turned on.');
                } else {
                    alert('Incorrect password.');
                }
            });
        });
    </script>
</body>
</html>
